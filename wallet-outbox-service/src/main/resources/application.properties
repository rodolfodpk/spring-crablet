spring.application.name=wallet-outbox-service
server.port=8081
# HTTP/2 Configuration - Enable for better performance and multiplexing
server.http2.enabled=true
# JDBC PostgreSQL Configuration with HikariCP
spring.datasource.url=jdbc:postgresql://localhost:5432/crablet
spring.datasource.username=crablet
spring.datasource.password=crablet
# HikariCP Connection Pool Configuration - Optimized for high concurrency
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.leak-detection-threshold=60000
# Prepared Statement Caching - Performance optimization
spring.datasource.hikari.data-source-properties.cachePrepStmts=true
spring.datasource.hikari.data-source-properties.prepStmtCacheSize=250
spring.datasource.hikari.data-source-properties.prepStmtCacheSqlLimit=2048
spring.datasource.hikari.data-source-properties.useServerPrepStmts=true
# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,circuitbreakers,retries,timelimiters,prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.prometheus.enabled=true
# Logging Configuration
logging.level.com.crablet=DEBUG
logging.level.org.springframework.jdbc=INFO
logging.level.com.zaxxer.hikari=INFO
logging.level.org.flywaydb=DEBUG
# Virtual Threads Configuration
spring.threads.virtual.enabled=true
# Resilience4j Configuration
resilience4j.circuitbreaker.instances.database.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.database.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.instances.database.sliding-window-size=10
resilience4j.circuitbreaker.instances.database.minimum-number-of-calls=5
resilience4j.circuitbreaker.instances.database.permitted-number-of-calls-in-half-open-state=3
resilience4j.circuitbreaker.instances.database.sliding-window-type=COUNT_BASED
resilience4j.retry.instances.database.max-attempts=3
resilience4j.retry.instances.database.wait-duration=1s
resilience4j.retry.instances.database.retry-exceptions=org.springframework.dao.DataAccessException,org.postgresql.util.PSQLException,java.sql.SQLException
resilience4j.timelimiter.instances.database.timeout-duration=15s
resilience4j.timelimiter.instances.database.cancel-running-future=true
# Enable Resilience4j metrics
management.metrics.enable.resilience4j=true
# Micrometer Prometheus Configuration
management.metrics.export.prometheus.enabled=true
management.metrics.export.prometheus.step=PT15S
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.percentiles.http.server.requests=0.5,0.95,0.99
management.metrics.distribution.percentiles-histogram.hikaricp.connections=true
management.metrics.distribution.percentiles.hikaricp.connections=0.5,0.95,0.99
# JVM Metrics Configuration
management.metrics.enable.jvm=true
management.metrics.enable.system=true
management.metrics.enable.process=true
management.metrics.enable.logback=true
# HikariCP Metrics Configuration
management.metrics.enable.hikaricp=true

# Outbox Configuration
crablet.outbox.enabled=true
crablet.outbox.batch-size=100
crablet.outbox.fetch-size=100
crablet.outbox.polling-interval-ms=1000
crablet.outbox.max-retries=3
crablet.outbox.retry-delay-ms=5000
crablet.outbox.lock-strategy=GLOBAL
crablet.outbox.heartbeat-ttl-seconds=30
crablet.outbox.acquisition-retry-interval-ms=30000

# Topic Configuration
crablet.outbox.topics.default.required-tags=
crablet.outbox.topics.default.publishers=LogPublisher,CountDownLatchPublisher

# Publisher Configuration
crablet.outbox.publishers.log.enabled=true
crablet.outbox.publishers.statistics.enabled=true
crablet.outbox.publishers.statistics.log-interval-seconds=10
crablet.outbox.publishers.global-statistics.enabled=true
crablet.outbox.publishers.global-statistics.log-interval-seconds=30
crablet.outbox.publishers.global-statistics.log-level=INFO

# Global statistics publisher configuration
crablet.outbox.global-statistics.enabled=true
crablet.outbox.global-statistics.log-interval-seconds=30
crablet.outbox.global-statistics.log-level=INFO
